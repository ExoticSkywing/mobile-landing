---
import { FaCcApplePay } from "react-icons/fa6";
import { BiSupport } from "react-icons/bi";
import { siteConfig } from "@config/site";

const { storeLinks } = siteConfig;
---

<div id="sticky-cta" class="fixed bottom-6 left-4 right-4 z-50 transform translate-y-[150%] opacity-0 transition-all duration-500 ease-out md:left-1/2 md:-translate-x-1/2 md:max-w-md">
    <div class="flex items-center justify-between p-2 pl-4 rounded-2xl bg-white/80 dark:bg-black/80 backdrop-blur-xl border border-gray-200/50 dark:border-white/10 shadow-lg shadow-black/5 dark:shadow-black/20 ring-1 ring-black/5 dark:ring-white/5">
        
        <!-- Left: Brand Info -->
        <div class="flex items-center gap-3 mr-auto">
            <div class="h-10 w-10 rounded-xl bg-gray-100 dark:bg-white/10 p-1 flex-shrink-0 border border-black/5 dark:border-white/10">
                <img src={siteConfig.logo} alt="Logo" class="w-full h-full rounded-lg object-cover" />
            </div>
            <div class="flex flex-col">
                <span class="text-sm font-bold text-gray-900 dark:text-white leading-tight">ParaSpace</span>
                <span class="text-[10px] font-medium text-gray-500 dark:text-gray-400 bg-gray-100 dark:bg-white/10 px-1.5 py-0.5 rounded w-fit mt-0.5">
                    官方正版授权
                </span>
            </div>
        </div>

        <!-- Right: Actions -->
        <div class="flex items-center gap-2">
            <!-- Support Button -->
            <a
                href={storeLinks.google}
                target="_blank"
                rel="noopener noreferrer"
                class="flex items-center justify-center w-10 h-10 rounded-xl bg-gray-100 dark:bg-white/10 text-gray-600 dark:text-white hover:bg-gray-200 dark:hover:bg-white/20 transition-colors"
                aria-label="Contact Support"
            >
                <BiSupport className="w-5 h-5" />
            </a>

            <!-- Buy Button -->
            <a
                href={storeLinks.apple}
                target="_blank"
                rel="noopener noreferrer"
                class="flex items-center gap-2 px-4 py-2.5 rounded-xl bg-gray-900 dark:bg-white text-white dark:text-black font-bold shadow-md hover:scale-105 active:scale-95 transition-all"
            >
                <FaCcApplePay className="w-4 h-4" />
                <span>立即购买</span>
            </a>
        </div>
    </div>
</div>

<style>
    /* Visibility State managed by Intersection Observer in parent */
    :global(#sticky-cta.is-visible) {
        transform: translateY(0);
        opacity: 1;
    }
    
    /* Desktop correction: keep centered when visible */
    @media (min-width: 768px) {
        :global(#sticky-cta.is-visible) {
            transform: translate(-50%, 0);
        }
    }
</style>
